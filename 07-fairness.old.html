<!DOCTYPE html>
<html lang="en"><head>
<script src="07-fairness.old_files/libs/quarto-html/tabby.min.js"></script>
<script src="07-fairness.old_files/libs/quarto-html/popper.min.js"></script>
<script src="07-fairness.old_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="07-fairness.old_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="07-fairness.old_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="07-fairness.old_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Matteo Francia   DISI — University of Bologna   m.francia@unibo.it">
  <title>Machine Learning and Data Mining (Module 2)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="07-fairness.old_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="07-fairness.old_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="07-fairness.old_files/libs/revealjs/dist/theme/quarto-6391498a111a1f00b0d941bda0c7e264.css">
  <link href="07-fairness.old_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="07-fairness.old_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="07-fairness.old_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="07-fairness.old_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Machine Learning and Data Mining (Module 2)</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Matteo Francia <br> DISI — University of Bologna <br> m.francia@unibo.it 
</div>
</div>
</div>

</section>
<section class="slide level2">

<p>Machine learning algorithms (e.g., classifiers) make predictions about new data <em>by training on old data</em>.</p>
<ul>
<li>These predictions may be hiring or not hiring, good or bad credit, and so on.</li>
</ul>
<p>However, the training data may contain patterns such as a higher rate of good outcomes for members of certain groups.</p>
<p>This is quantified by the “80% rule” of disparate impact, which is a legal measure and definition of bias.</p>
<ul>
<li><span class="math inline">\(\frac{\text{Rate of unprivileged applicants receiving good outcome}}{\text{Rate of privileged applicants receiving good outcome}} &lt; 0.8\)</span></li>
</ul>
<p>It is ethically and legally undesirable for a classifier to learn these biases from the data.</p>
<p>We propose two methods of modifying data, called Combinatorial and Geometric repair. We test our repairs on three data sets. Experiments show that our repairs perform favorably in terms of training classifiers that are both accurate and unbiased.</p>
</section>
<section id="regulations" class="title-slide slide level1 center">
<h1>Regulations</h1>
<p>Regulation without enforcement is meaningless. We have to go beyond obsession for regulation.</p>
</section>

<section id="racism" class="title-slide slide level1 center">
<h1>Racism</h1>
<p>Racism and AI: Bias from the past leads to bias in the future. https://www.ohchr.org/en/stories/2024/07/racism-and-ai-bias-past-leads-bias-future</p>
</section>

<section id="datasets" class="title-slide slide level1 center">
<h1>Datasets</h1>
<p>Can we change our datasets? Images on the internet are even more sexist than texts. You go back in time, how would that community be like when taking selfies.</p>
<p>From training to teaching AI</p>
<p><em>Training</em></p>
<ul>
<li>Repetition and optimization</li>
<li>Reproductive approach</li>
</ul>
<p><em>Teaching</em></p>
<ul>
<li>Dialogic and social processes</li>
<li>Reflexive approach</li>
<li>Data as communicative practices</li>
<li>Data encodes values, contexts, and cultures</li>
<li>Goal of diversification</li>
</ul>
<p>De-biasing datasets</p>
<ul>
<li>Should be continuous over time since society is changing.</li>
<li>Public institutions should push towards open data, but what about the private sector?
<ul>
<li>Burden of the proof should fall on the provider.</li>
<li>Privacy was dealt with consent, do not make the same mistake again.</li>
</ul></li>
</ul>
<p>CVs</p>
<ul>
<li>Identity &amp; agency: is it descriptive or discriminative?</li>
<li>Networks of Visibility: de-anonymization based on connections</li>
</ul>
<p>GeoAI</p>
</section>

<section id="fair-division" class="title-slide slide level1 center">
<h1>Fair division</h1>
<p>Distributing resources in a way that each perceives the division as fair</p>
<ul>
<li>Some things are indivisible</li>
</ul>
<p><em>Comparison-based</em>: no one envies anyone else (but I need to know all the assignments)</p>
<ul>
<li>Envy free (up to 1 good)</li>
</ul>
<p><em>Threshold-based</em></p>
<ul>
<li>Proportionality (up to 1 good)</li>
</ul>
<p>Computational feasibility is NP-complete What happens if there is no fair solution?</p>
<p>Social impact metric</p>
<ul>
<li>Find a fair solution and maximize its social impact (Price of Fairness = best possible solution / best social impact of a fair solution)</li>
<li>Individual vs group fairness: the goal is also to counter historical disadvantages (this is about pink quotas)
<ul>
<li>You can weigh a group of people more than others when computing fairness</li>
</ul></li>
<li>Sandra Buttock paper</li>
</ul>
</section>

<section id="ai-act" class="title-slide slide level1 center">
<h1>AI Act</h1>
<p>How are we implementing the AI Act?</p>
<ul>
<li>A lot of the requirements are not clear about their implementation</li>
<li>Difficulty in terms of language (law and computer science backgrounds)</li>
</ul>
<p>Are we also considering that not using AI sometimes is the right solution?</p>
<ul>
<li>E.g., do not always increase the size of the gun, but use the simplest working tools</li>
</ul>
</section>

<section id="privacy" class="title-slide slide level1 center">
<h1>Privacy</h1>
<p>Privacy hinders AI. Fairness is the only tools to safeguard people’s privacy (GDPR).</p>
<p>There is no technological solution to a problem that is political</p>
<p>Companies have created AI governance. We need a common ground between technicians and humanistic people. You cannot use the same metric in any scenarios For a lot of companies AI means buying off the shelf products.</p>
<p>Fairness and transparency about processes goes beyond GDPR (since GDPR is only about personal data). But if the task is only preparatory, that is not high risk, and many constraints can be dropped. For most companies, AI is not about developing but buying.</p>
</section>

<section id="social-scoring" class="title-slide slide level1 center">
<h1>Social scoring</h1>

</section>

<section id="llms" class="title-slide slide level1 center">
<h1>LLMs</h1>

</section>

<section id="fairness-and-companies" class="title-slide slide level1 center">
<h1>Fairness and companies</h1>
<p>Is there a chief AI office? Fairness and explainability. Fairness is part of the development and whole lifecycle of the project. It is important to position wrt the AI act.</p>
</section>

<section id="papers" class="title-slide slide level1 center">
<h1>Papers</h1>
<ol type="1">
<li>Bias preservation in machine learning: the legality of fairness metrics under EU non-discrimination law.</li>
<li>Why fairness cannot be automated: Bridging the gap between EU non-discrimination law and AI.</li>
<li>Compatibility of Fairness Metrics with EU Non-Discrimination Laws: Demographic Parity &amp; Conditional Demographic Disparity.</li>
<li>Distrust by design.
<ul>
<li>Accountability: how can we deal with whose fault is?</li>
</ul></li>
<li>Holigarcs book.</li>
</ol>
</section>

<section id="other-examples" class="title-slide slide level1 center">
<h1>Other examples</h1>
<p>Biases in the definition of the target variable are especially critical, because they are guaranteed to bias the predictions relative to the actual construct we intended to predict, as is the case when we use arrests as a measure of crime, or sales as a measure of job performance</p>
<p>If our target variable is the idea of a “good employee,” we might use performance review scores to quantify it. This means that our data inherit any biases present in managers’ evaluations of their reports. Another example is the use of computer vision to automatically rank people’s physical attractiveness [10, 11]. The training data consist of human evaluation of attractiveness, and, unsurprisingly, all these classifiers showed a preference for lighter skin.</p>
<p>In hiring, instead of relying on performance reviews for, say, a sales job, we might rely on the number of sales closed. But is that an objective measurement or is it subject to the prejudices of the potential customers (who might respond more positively to certain salespeople than to others) and workplace conditions (which might be a hostile environment for some but not others)?</p>
<p>The visual world has an essentially infinite bandwidth compared to what can be captured by cameras, whether film or digital, which means that photography technology involves a series of choices about what is relevant and what isn’t, and transforms the captured data based on those choices. Both film and digital cameras have historically been more adept at photographing lighter-skinned individuals [16]. One reason is the default settings, such as color balance, which were optimized for lighter skin tones. Another, deeper reason is the limited “dynamic range” of cameras, which makes it hard to capture brighter and darker tones in the same image. This started changing in the 1970s, in part due to complaints from furniture companies and chocolate companies about the difficulty of photographically capturing the details of furniture and chocolate, respectively! Another impetus came from the increasing diversity of television subjects at this time.</p>
<p>Even if someone else has collected the data, they are almost always too messy for algorithms to handle, hence the dreaded “data cleaning” step. But the messiness of the real world isn’t just an annoyance to be dealt with by cleaning. It is a manifestation of a diverse world in which people don’t fit neatly into categories. Being inattentive to these nuances can particularly hurt marginalized populations.</p>
</section>

<section id="more-issues" class="title-slide slide level1 center">
<h1>More issues</h1>
<p>If subpopulations change differently over time, but the model isn’t retrained, that can introduce disparities. An additional wrinkle: whether or not disparities are objectionable may differ between cultures and may change over time as social norms evolve</p>
</section>

<section id="computational-fairness" class="title-slide slide level1 center">
<h1>Computational fairness</h1>
<p><em>Fairness</em> comes from the law (article 21 of the fundamental rights)</p>
<p>Discrimination, different treatments</p>
<ul>
<li>Direct</li>
<li>Indirect discrimination: something that seems neutral but applies discrimination</li>
<li>Intersectional? discrimination</li>
</ul>
<p><em>Computational fairness</em>: algorithms should not perform any discrimination.</p>
<ul>
<li>We need to quantify the level of (un)fairness</li>
</ul>
<p><em>Multidisciplinary</em> approach is a must, at least three perspectives: legal, social, and technical</p>
<ul>
<li>Legal: we have a lot of regulations such as AI acts, article 21, national and sectorial regulations</li>
<li>How do we move this into something quantifiable?
<ul>
<li>Which metrics should we use?</li>
<li>Metrics should be legally sound in terms of laws.</li>
<li>Metrics conflict with each other</li>
<li>Metrics are threshold-based: who defines the thresholds?</li>
</ul></li>
</ul>
<p>Fairness is contextual to the application, an application is FAIR inside some boundaries but not others.</p>
<ul>
<li>How do we define the boundaries?
<ul>
<li>Participative design (see: holistic social-legal-technical methodology for AI fairness)</li>
</ul></li>
<li>Boundaries can be based on a context</li>
</ul>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Matteo Francia - Machine Learning and Data Mining (Module 2) - A.Y. 2024/25</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="07-fairness.old_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="07-fairness.old_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="07-fairness.old_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="07-fairness.old_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>